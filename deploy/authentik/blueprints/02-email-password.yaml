# Authentik Blueprint for Email/Password Authentication
# Enables email/password signup and login alongside social providers
# This is the primary blueprint for identification stage configuration
version: 1
metadata:
  name: Email Password Authentication
  labels:
    blueprints.goauthentik.io/instantiate: "true"

entries:
  # Configure identification stage with all authentication options
  # - Email/password login with signup and recovery
  # - Social login sources (GitHub, etc.)
  - model: authentik_stages_identification.identificationstage
    id: email-password-identification
    identifiers:
      name: default-authentication-identification
    attrs:
      user_fields:
        - email
        - username
      show_source_labels: true
      # Enable sign up link
      enrollment_flow: !Find [authentik_flows.flow, [slug, default-enrollment-flow]]
      # Enable password recovery link
      recovery_flow: !Find [authentik_flows.flow, [slug, default-recovery-flow]]
      # Include social login sources (GitHub added by github-oauth.yaml if configured)
      sources:
        - !Find [authentik_sources_oauth.oauthsource, [slug, github]]
