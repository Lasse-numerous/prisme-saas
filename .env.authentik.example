# Authentik Environment Configuration
#
# AUTO-GENERATED BY PRISM - DO NOT EDIT
# Copy this file to .env.authentik and fill in the values.
#
# SECURITY: Never commit .env.authentik to version control!

# =============================================================================
# DOMAIN CONFIGURATION
# =============================================================================

# Your primary domain (e.g., example.com)
DOMAIN=${DOMAIN}

# SSL certificate email (for Let's Encrypt notifications)
SSL_EMAIL=${SSL_EMAIL}

# =============================================================================
# AUTHENTIK CONFIGURATION
# =============================================================================

# Authentik version (see: https://github.com/goauthentik/authentik/releases)
AUTHENTIK_VERSION=2024.2

# Secret key for Authentik (generate with: openssl rand -base64 36)
AUTHENTIK_SECRET_KEY=

# Database credentials
AUTHENTIK_DB_USER=authentik
AUTHENTIK_DB_NAME=authentik
AUTHENTIK_DB_PASSWORD=

# =============================================================================
# APPLICATION OIDC CONFIGURATION
# =============================================================================
# These values are obtained from Authentik after creating an OAuth2/OIDC provider

# OIDC Client credentials (from Authentik application)
AUTHENTIK_CLIENT_ID=
AUTHENTIK_CLIENT_SECRET=

# Authentik URLs (typically auto-derived, but can be overridden)
# For staging: https://auth-staging.madewithpris.me/application/o/madewithprisme/
# For production: https://auth.madewithpris.me/application/o/madewithprisme/
AUTHENTIK_ISSUER_URL=https://auth.${DOMAIN}/application/o/madewithprisme/

# Redirect URI for OAuth callback (must match Authentik application config)
AUTHENTIK_REDIRECT_URI=https://${DOMAIN}/api/auth/callback

# Post-logout redirect URI
AUTHENTIK_POST_LOGOUT_REDIRECT_URI=https://${DOMAIN}/

# Webhook secret for user sync (generate with: openssl rand -hex 32)
AUTHENTIK_WEBHOOK_SECRET=

# =============================================================================
# EMAIL CONFIGURATION (Optional)
# =============================================================================
# Required for email verification and password reset features

SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM=noreply@${DOMAIN}

# =============================================================================
# INITIAL SETUP NOTES
# =============================================================================
#
# After starting the stack with docker compose:
#
# 1. Access Authentik at https://auth.${DOMAIN}/
#
# 2. Create initial admin account:
#    docker compose -f docker-compose.authentik.yml exec authentik-server \
#      ak create_recovery_key 10 akadmin
#
# 3. Create an OAuth2/OIDC Provider:
#    - Go to Admin Interface > Providers > Create
#    - Select "OAuth2/OpenID Provider"
#    - Name: madewithprisme
#    - Client ID: (copy to AUTHENTIK_CLIENT_ID above)
#    - Client Secret: (copy to AUTHENTIK_CLIENT_SECRET above)
#    - Redirect URIs: https://${DOMAIN}/api/auth/callback
#    - Signing Key: authentik Self-signed Certificate
#
# 4. Create an Application:
#    - Go to Admin Interface > Applications > Create
#    - Name: MadeWithPris.me API
#    - Slug: madewithprisme
#    - Provider: Select the provider created above
#    - Launch URL: https://${DOMAIN}/
#
# 5. Configure Webhook for User Sync (optional):
#    - Go to Admin Interface > System > Outposts
#    - Or use Authentik's event system to trigger webhooks
#
# 6. Restart your application to apply the configuration
