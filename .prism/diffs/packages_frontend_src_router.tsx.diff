--- generated+++ user@@ -11,10 +11,9 @@ import { ThemeToggle } from './ui/ThemeToggle';
 import { Login } from './pages/Login';
 import { Signup } from './pages/Signup';
-import { ForgotPasswordForm } from './components/auth/ForgotPasswordForm';
-import ResetPassword from './pages/ResetPassword';
-import VerifyEmail from './pages/VerifyEmail';
-import AuthCallback from './pages/AuthCallback';
+import { ForgotPassword } from './pages/ForgotPassword';
+import { AuthCallback } from './components/auth/AuthCallback';
+import { ProtectedRoute } from './components/auth/ProtectedRoute';
 import UsersListPage from './pages/users';
 import UserDetailPage from './pages/users/[id]';
 import UserCreatePage from './pages/users/new';
@@ -27,15 +26,13 @@ import SubdomainDetailPage from './pages/subdomains/[id]';
 import SubdomainCreatePage from './pages/subdomains/new';
 import SubdomainEditPage from './pages/subdomains/[id]/edit';
-import AllowedEmailDomainsListPage from './pages/allowed-email-domains';
-import AllowedEmailDomainDetailPage from './pages/allowed-email-domains/[id]';
-import AllowedEmailDomainCreatePage from './pages/allowed-email-domains/new';
-import AllowedEmailDomainEditPage from './pages/allowed-email-domains/[id]/edit';
 import { useAuth } from './contexts/AuthContext';

 // PRISM:PROTECTED:START - Custom Imports
-// Add your custom page imports here:
-// import MyCustomPage from './pages/custom';
+import LandingPage from './pages/LandingPage';
+import Dashboard from './pages/Dashboard';
+import ResetPassword from './pages/ResetPassword';
+import VerifyEmail from './pages/VerifyEmail';
 // PRISM:PROTECTED:END

 /** App name and description for branding */
@@ -77,6 +74,8 @@
           {/* Navigation */}
           <nav className="flex-1 px-3 py-4 space-y-1 overflow-y-auto">
+          {/* Admin-only: Users management */}
+          {user?.roles?.includes('admin') && (
           <NavLink
             to="/users"
             className={({ isActive }) =>
@@ -88,10 +87,13 @@             }
           >
             <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
-              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
+              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
             </svg>
             Users
           </NavLink>
+          )}
+          {/* Protected: API Keys (any authenticated user) */}
+          {isAuthenticated && (
           <NavLink
             to="/api-keys"
             className={({ isActive }) =>
@@ -103,10 +105,13 @@             }
           >
             <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
-              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
-            </svg>
-            APIKeys
-          </NavLink>
+              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
+            </svg>
+            API Keys
+          </NavLink>
+          )}
+          {/* Protected: Subdomains (any authenticated user) */}
+          {isAuthenticated && (
           <NavLink
             to="/subdomains"
             className={({ isActive }) =>
@@ -118,25 +123,46 @@             }
           >
             <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
-              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
+              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
             </svg>
             Subdomains
           </NavLink>
-          <NavLink
-            to="/allowed-email-domains"
-            className={({ isActive }) =>
-              `flex items-center gap-3 px-3 py-2 rounded-nordic text-sm font-medium transition-colors ${
-                isActive
-                  ? 'bg-nordic-100 text-nordic-900'
-                  : 'text-nordic-600 hover:bg-nordic-50 hover:text-nordic-900'
-              }`
-            }
-          >
-            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
-              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
-            </svg>
-            AllowedEmailDomains
-          </NavLink>
+          )}
+          {/* Unauthenticated: Login/Signup */}
+          {!isAuthenticated && (
+          <>
+          <NavLink
+            to="/login"
+            className={({ isActive }) =>
+              `flex items-center gap-3 px-3 py-2 rounded-nordic text-sm font-medium transition-colors ${
+                isActive
+                  ? 'bg-nordic-100 text-nordic-900'
+                  : 'text-nordic-600 hover:bg-nordic-50 hover:text-nordic-900'
+              }`
+            }
+          >
+            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
+              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
+            </svg>
+            Login
+          </NavLink>
+          <NavLink
+            to="/signup"
+            className={({ isActive }) =>
+              `flex items-center gap-3 px-3 py-2 rounded-nordic text-sm font-medium transition-colors ${
+                isActive
+                  ? 'bg-nordic-100 text-nordic-900'
+                  : 'text-nordic-600 hover:bg-nordic-50 hover:text-nordic-900'
+              }`
+            }
+          >
+            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
+              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
+            </svg>
+            Sign Up
+          </NavLink>
+          </>
+          )}
             {/* PRISM:PROTECTED:START - Custom Nav Links */}
             {/* Add your custom navigation links here */}
             {/* PRISM:PROTECTED:END */}
@@ -186,23 +212,10 @@   );
 }

-/** Home page with welcome message */
+/** Home page: landing for guests, dashboard for authenticated users */
 function HomePage(): ReactElement {
-  return (
-    <div className="page-container">
-      <div className="card p-8 text-center">
-        <div className="w-16 h-16 bg-surface-sunken rounded-full flex items-center justify-center mx-auto mb-4">
-          <svg className="w-8 h-8 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
-            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M13 10V3L4 14h7v7l9-11h-7z" />
-          </svg>
-        </div>
-        <h1 className="text-2xl font-semibold text-foreground mb-2">Welcome</h1>
-        <p className="text-muted max-w-md mx-auto">
-          Select an item from the sidebar to get started.
-        </p>
-      </div>
-    </div>
-  );
+  const { isAuthenticated } = useAuth();
+  return isAuthenticated ? <Dashboard /> : <LandingPage />;
 }

 /** Application router with all model routes */
@@ -211,31 +224,28 @@     element: <Layout />,
     children: [
       { path: '/', element: <HomePage /> },
-  { path: '/login', element: <Login /> },
-  { path: '/signup', element: <Signup /> },
-  { path: '/forgot-password', element: <ForgotPasswordForm /> },
-  { path: '/reset-password', element: <ResetPassword /> },
-  { path: '/verify-email', element: <VerifyEmail /> },
-  { path: '/auth/callback', element: <AuthCallback /> },
-  { path: '/users', element: <UsersListPage /> },
-  { path: '/users/:id', element: <UserDetailPage /> },
-  { path: '/users/new', element: <UserCreatePage /> },
-  { path: '/users/:id/edit', element: <UserEditPage /> },
-  { path: '/api-keys', element: <APIKeysListPage /> },
-  { path: '/api-keys/:id', element: <APIKeyDetailPage /> },
-  { path: '/api-keys/new', element: <APIKeyCreatePage /> },
-  { path: '/api-keys/:id/edit', element: <APIKeyEditPage /> },
-  { path: '/subdomains', element: <SubdomainsListPage /> },
-  { path: '/subdomains/:id', element: <SubdomainDetailPage /> },
-  { path: '/subdomains/new', element: <SubdomainCreatePage /> },
-  { path: '/subdomains/:id/edit', element: <SubdomainEditPage /> },
-  { path: '/allowed-email-domains', element: <AllowedEmailDomainsListPage /> },
-  { path: '/allowed-email-domains/:id', element: <AllowedEmailDomainDetailPage /> },
-  { path: '/allowed-email-domains/new', element: <AllowedEmailDomainCreatePage /> },
-  { path: '/allowed-email-domains/:id/edit', element: <AllowedEmailDomainEditPage /> },
+      // Public routes
+      { path: '/login', element: <Login /> },
+      { path: '/signup', element: <Signup /> },
+      { path: '/forgot-password', element: <ForgotPassword /> },
+      { path: '/auth/callback', element: <AuthCallback /> },
+      // Admin-only routes (Users management)
+      { path: '/users', element: <ProtectedRoute roles={['admin']}><UsersListPage /></ProtectedRoute> },
+      { path: '/users/:id', element: <ProtectedRoute roles={['admin']}><UserDetailPage /></ProtectedRoute> },
+      { path: '/users/new', element: <ProtectedRoute roles={['admin']}><UserCreatePage /></ProtectedRoute> },
+      { path: '/users/:id/edit', element: <ProtectedRoute roles={['admin']}><UserEditPage /></ProtectedRoute> },
+      // Protected routes (any authenticated user - users see their own)
+      { path: '/api-keys', element: <ProtectedRoute><APIKeysListPage /></ProtectedRoute> },
+      { path: '/api-keys/:id', element: <ProtectedRoute><APIKeyDetailPage /></ProtectedRoute> },
+      { path: '/api-keys/new', element: <ProtectedRoute><APIKeyCreatePage /></ProtectedRoute> },
+      { path: '/api-keys/:id/edit', element: <ProtectedRoute><APIKeyEditPage /></ProtectedRoute> },
+      { path: '/subdomains', element: <ProtectedRoute><SubdomainsListPage /></ProtectedRoute> },
+      { path: '/subdomains/:id', element: <ProtectedRoute><SubdomainDetailPage /></ProtectedRoute> },
+      { path: '/subdomains/new', element: <ProtectedRoute><SubdomainCreatePage /></ProtectedRoute> },
+      { path: '/subdomains/:id/edit', element: <ProtectedRoute><SubdomainEditPage /></ProtectedRoute> },
       // PRISM:PROTECTED:START - Custom Routes
-      // Add your custom routes here:
-      // { path: '/custom', element: <MyCustomPage /> },
+      { path: '/reset-password', element: <ResetPassword /> },
+      { path: '/verify-email', element: <VerifyEmail /> },
       // PRISM:PROTECTED:END
     ],
   },
